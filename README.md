# CiviC Compiler
This repository was created as part of the **Compiler Construction** lecture at Friedrich Schiller 
University Jena during the winter term 2025.
With this compiler we support the CiviC language, which is reduced C-like toy language the understand
and develop the basic functionality of a Compiler. For the development we leverage the 
[Coconut Framework](https://github.com/CoCoNut-UvA/coconut), which generates based on a own 
[DSL](https://coconut-uva.github.io/coconut/dsl_syntax.html) a specifc AST. Different passes can then
be used to generate, optimize, or even print the AST.

## Requierements
The full dependencies of CoCoNut are listed on the [Coconut](https://github.com/CoCoNut-UvA/coconut)
repository. 

**Supported Systems:** Linux, MacOs

### Linux

On Ubuntu the requierement can be install with:
```bash
sudo apt update && sudo apt install build-essential cmake bison flex graphviz
```
For macOS, see [macOS dependencies](#macos-dependencies).

## MacOS 
The following build dependencies are required on macOS:
```bash
brew install cmake coreutils binutils bison graphviz gnu-tar
```

You might also need to run the following for cmake to find Bison:
```bash
echo "export PATH=\"$(brew --prefix)/opt/bison/bin:\$PATH\"" >> ~/.zshrc
```

**Note:** Make sure to fully restart your terminal after adding this line to `.zshrc`, and also 
delete the folder `build` if it exists. Otherwise cmake will keep using the old unsupported Bison 
version that macOS ships with.

## Building the Project
CMake is used to build this Project.
You can use the following command to configure and build the project into the `build` folder.
```
cmake -B build && cmake --build build -j <jobs>
```

In addition a compact command is provided with the `Makefile`.
The debug version of the project is build by running.
```
make
```

Further a release version can be build with:
```
make release
```

For further infomation and additional targets run: 
```
make help
```


## VS Code support
For syntax highlighting of the CoCoNut DSL files (e.g. the `main.ccn` file), you can install the 
[nutcracker](https://github.com/CoCoNut-UvA/nutcracker/) extension from the Visual Studio Marketplace 
[here](https://marketplace.visualstudio.com/items?itemName=CoCoNut-UvA.nutcracker).

We provide a Linux configuration file in [`.vscode/c_cpp_properties.json`](.vscode/c_cpp_properties.json) 
that helps IntelliSense to find the header files generated by cocogen.
VS code should pick this up automatically; if you open a C file you should see CoCoNut-Linux in 
the bottom-right corner.

## Creating an archive
You can quickly create an archive for submitting to canvas as follows
```bash
make dist
```
this gets everything in your git repo and combines it with the used coconut version in one archive.
This should contain everything needed to hand in your assignments.
**NOTE:** Always check the resulting archive if it contains everything and builds correctly.
